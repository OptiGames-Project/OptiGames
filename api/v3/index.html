<html><head><base href="/">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Editor de Código HTML</title>
<style>
  :root {
    --primary: #2563eb;
    --secondary: #1e293b;
    --surface: #0f172a;
    --text: #e2e8f0;
    --hover: #3b82f6;
  }

  body {
    background: var(--surface);
    color: var(--text);
  }

  .container {
    display: flex;
    flex-direction: column;
    height: 100vh;
  }

  .menu-bar {
    background: var(--secondary);
    padding: 12px 20px;
    gap: 15px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }

  .button {
    background: var(--primary);
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: 500;
    letter-spacing: 0.3px;
    border: 1px solid rgba(255,255,255,0.1);
    transition: all 0.2s ease;
  }

  .button:hover {
    background: var(--hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(37,99,235,0.2);
  }

  .editor-container {
    display: flex;
    flex: 1;
  }

  .code-editor {
    flex: 1;
    background: var(--surface);
    padding: 24px;
    resize: none;
    color: #d4d4d4;
    font-size: 15px;
    line-height: 1.6;
    border-right: 1px solid rgba(255,255,255,0.1);
    outline: none;
    tab-size: 2;
  }

  .preview {
    flex: 1;
    background: #ffffff;
    padding: 24px;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
  }

  .preview iframe {
    width: 100%;
    height: 100%;
    border: none;
  }

  .status-bar {
    background: var(--secondary);
    color: var(--text);
    padding: 8px 20px;
    font-size: 13px;
    border-top: 1px solid rgba(255,255,255,0.1);
  }

  .dropdown {
    position: relative;
    display: inline-block;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    background: var(--secondary);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 8px;
    margin-top: 5px;
    padding: 4px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    z-index: 1;
  }

  .dropdown-content a {
    color: white;
    padding: 10px 16px;
    border-radius: 4px;
    transition: all 0.2s ease;
    display: block;
  }

  .dropdown-content a:hover {
    background: var(--primary);
  }

  .dropdown:hover .dropdown-content {
    display: block;
  }

  .language-switch {
    display: flex;
    align-items: center;
    margin-left: auto;
  }

  .language-switch button {
    background: var(--secondary);
    border: 1px solid rgba(255,255,255,0.1);
    padding: 6px 12px;
    transition: all 0.2s ease;
  }

  .language-switch button.active {
    background: var(--primary);
    font-weight: 500;
  }

  .language-switch button:hover {
    background: var(--hover);
  }
</style>
</head>
<body>
<div class="container">
  <div class="menu-bar">
    <div class="dropdown">
      <button class="button" id="fileMenuBtn">Archivo</button>
      <div class="dropdown-content">
        <a href="javascript:void(0)" onclick="newFile()" id="newFileBtn">Nuevo</a>
        <a href="javascript:void(0)" onclick="openFile()" id="openFileBtn">Abrir</a>
        <a href="javascript:void(0)" onclick="saveFile()" id="saveFileBtn">Guardar</a>
      </div>
    </div>
    
    <div class="dropdown">
      <button class="button" id="editMenuBtn">Editar</button>
      <div class="dropdown-content">
        <a href="javascript:void(0)" onclick="undo()" id="undoBtn">Deshacer</a>
        <a href="javascript:void(0)" onclick="redo()" id="redoBtn">Rehacer</a>
        <a href="javascript:void(0)" onclick="selectAll()" id="selectAllBtn">Seleccionar Todo</a>
      </div>
    </div>
    
    <div class="dropdown">
      <button class="button" id="viewMenuBtn">Ver</button>
      <div class="dropdown-content">
        <a href="javascript:void(0)" onclick="togglePreview()" id="togglePreviewBtn">Mostrar/Ocultar Preview</a>
        <a href="javascript:void(0)" onclick="toggleLineNumbers()" id="toggleLineNumbersBtn">Mostrar/Ocultar Números de Línea</a>
      </div>
    </div>
    
    <button class="button" onclick="runCode()" id="runBtn">Ejecutar</button>

    <div class="language-switch">
      <button onclick="changeLanguage('es')" id="esBtn" class="active">ES</button>
      <button onclick="changeLanguage('en')" id="enBtn">EN</button>
    </div>
  </div>

  <div class="editor-container">
    <textarea id="codeEditor" class="code-editor" spellcheck="false"><!DOCTYPE html>
<html>
<head>
  <title>Mi Página</title>
</head>
<body>
  <h1>¡Hola Mundo!</h1>
</body>
</html></textarea>
    <div id="preview" class="preview">
      <iframe id="previewFrame"></iframe>
    </div>
  </div>

  <div class="status-bar">
    Línea: <span id="lineCount">1</span>, Columna: <span id="colCount">1</span>
  </div>
</div>

<script>
const codeEditor = document.getElementById('codeEditor');
const preview = document.getElementById('preview');
const previewFrame = document.getElementById('previewFrame');
const lineCount = document.getElementById('lineCount');
const colCount = document.getElementById('colCount');

let history = [];
let historyIndex = -1;

// Función para actualizar la vista previa
function updatePreview() {
  const iframe = document.getElementById('previewFrame');
  const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
  
  // Reset the iframe content
  iframeDoc.open();
  iframeDoc.write(codeEditor.value);
  iframeDoc.close();
  
  // Handle any script execution
  const scripts = iframeDoc.getElementsByTagName('script');
  for(let i = 0; i < scripts.length; i++) {
    const script = scripts[i];
    const newScript = iframeDoc.createElement('script');
    
    // Copy script attributes
    Array.from(script.attributes).forEach(attr => {
      newScript.setAttribute(attr.name, attr.value);
    });
    
    // Copy script content
    newScript.textContent = script.textContent;
    
    // Replace old script with new one
    script.parentNode.replaceChild(newScript, script);
  }
}

// Actualizar la vista previa cuando se escribe
codeEditor.addEventListener('input', () => {
  updatePreview();
  saveToHistory();
});

// Funciones del menú Archivo
function newFile() {
  if (confirm('¿Desea crear un nuevo archivo? Los cambios no guardados se perderán.')) {
    codeEditor.value = '<!DOCTYPE html>\n<html>\n<head>\n  <title>Mi Página</title>\n</head>\n<body>\n  \n</body>\n</html>';
    updatePreview();
  }
}

function openFile() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.html,.htm';
  input.onchange = (e) => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = (event) => {
      codeEditor.value = event.target.result;
      updatePreview();
    };
    reader.readAsText(file);
  };
  input.click();
}

function saveFile() {
  const blob = new Blob([codeEditor.value], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'index.html';
  a.click();
  URL.revokeObjectURL(url);
}

// Funciones del menú Editar
function saveToHistory() {
  historyIndex++;
  history = history.slice(0, historyIndex);
  history.push(codeEditor.value);
}

function undo() {
  if (historyIndex > 0) {
    historyIndex--;
    codeEditor.value = history[historyIndex];
    updatePreview();
  }
}

function redo() {
  if (historyIndex < history.length - 1) {
    historyIndex++;
    codeEditor.value = history[historyIndex];
    updatePreview();
  }
}

function selectAll() {
  codeEditor.select();
}

// Funciones del menú Ver
function togglePreview() {
  preview.style.display = preview.style.display === 'none' ? 'block' : 'none';
}

function toggleLineNumbers() {
  // Implementación de números de línea
  // Esta es una versión simplificada
  const hasLineNumbers = codeEditor.classList.contains('with-line-numbers');
  if (hasLineNumbers) {
    codeEditor.classList.remove('with-line-numbers');
  } else {
    codeEditor.classList.add('with-line-numbers');
  }
}

// Función para ejecutar el código
function runCode() {
  const newWindow = window.open('', '_blank');
  newWindow.document.write(codeEditor.value);
  newWindow.document.close();
}

// Actualizar contador de línea y columna
codeEditor.addEventListener('keyup', (e) => {
  const pos = codeEditor.selectionStart;
  const text = codeEditor.value.substring(0, pos);
  const lines = text.split('\n');
  const currentLine = lines.length;
  const currentCol = lines[lines.length - 1].length + 1;
  
  lineCount.textContent = currentLine;
  colCount.textContent = currentCol;
});

// Soporte para la tecla Tab
codeEditor.addEventListener('keydown', (e) => {
  if (e.key === 'Tab') {
    e.preventDefault();
    const start = codeEditor.selectionStart;
    const end = codeEditor.selectionEnd;
    codeEditor.value = codeEditor.value.substring(0, start) + '  ' + codeEditor.value.substring(end);
    codeEditor.selectionStart = codeEditor.selectionEnd = start + 2;
    updatePreview();
  }
});

// Language translations
const translations = {
  en: {
    fileMenu: "File",
    newFile: "New",
    openFile: "Open",
    saveFile: "Save",
    editMenu: "Edit",
    undo: "Undo",
    redo: "Redo",
    selectAll: "Select All",
    viewMenu: "View",
    togglePreview: "Toggle Preview",
    toggleLineNumbers: "Toggle Line Numbers",
    run: "Run",
    line: "Line",
    column: "Column"
  },
  es: {
    fileMenu: "Archivo",
    newFile: "Nuevo",
    openFile: "Abrir",
    saveFile: "Guardar",
    editMenu: "Editar",
    undo: "Deshacer",
    redo: "Rehacer",
    selectAll: "Seleccionar Todo",
    viewMenu: "Ver",
    togglePreview: "Mostrar/Ocultar Preview",
    toggleLineNumbers: "Mostrar/Ocultar Números de Línea",
    run: "Ejecutar",
    line: "Línea",
    column: "Columna"
  }
};

function changeLanguage(lang) {
  // Update button states
  document.getElementById('esBtn').classList.toggle('active', lang === 'es');
  document.getElementById('enBtn').classList.toggle('active', lang === 'en');

  // Update all text content
  document.getElementById('fileMenuBtn').textContent = translations[lang].fileMenu;
  document.getElementById('newFileBtn').textContent = translations[lang].newFile;
  document.getElementById('openFileBtn').textContent = translations[lang].openFile;
  document.getElementById('saveFileBtn').textContent = translations[lang].saveFile;
  
  document.getElementById('editMenuBtn').textContent = translations[lang].editMenu;
  document.getElementById('undoBtn').textContent = translations[lang].undo;
  document.getElementById('redoBtn').textContent = translations[lang].redo;
  document.getElementById('selectAllBtn').textContent = translations[lang].selectAll;
  
  document.getElementById('viewMenuBtn').textContent = translations[lang].viewMenu;
  document.getElementById('togglePreviewBtn').textContent = translations[lang].togglePreview;
  document.getElementById('toggleLineNumbersBtn').textContent = translations[lang].toggleLineNumbers;
  
  document.getElementById('runBtn').textContent = translations[lang].run;

  // Save language preference
  localStorage.setItem('editorLanguage', lang);
}

// Load saved language preference on startup
document.addEventListener('DOMContentLoaded', () => {
  const savedLang = localStorage.getItem('editorLanguage') || 'es';
  changeLanguage(savedLang);
});

// Inicialización
updatePreview();
saveToHistory();
</script>
</body>
</html>